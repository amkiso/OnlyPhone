@model OnlyPhone.Models.UserProfileViewModel
@{
    ViewBag.Title = "Thông tin cá nhân";
    Layout = null;
}

<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>@ViewBag.Title</title>
    <link href="~/Content/Css/profile.css" rel="stylesheet" />
    <link href="~/Content/FontAwesome/css/all.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <header>
            <div class="avatar-wrap" id="avatarWrap" title="Avatar người dùng">
                <img id="avatarImg" class="avatar" src="@Url.Content(Model.AvatarPath)" alt="avatar">
                <div class="avatar-overlay" id="avatarOverlay">
                    <i class="fas fa-camera"></i>
                    <span>Thay đổi ảnh</span>
                </div>
            </div>
        </header>

        <main class="card" role="main" aria-labelledby="profileTitle">
            <div class="card-inner">
                <h2 id="profileTitle" style="margin:0 0 8px 0;">Thông tin cá nhân</h2>

                @if (TempData["SuccessMessage"] != null)
                {
                    <div class="alert alert-success">
                        <i class="fas fa-check-circle"></i> @TempData["SuccessMessage"]
                    </div>
                }

                @if (TempData["ErrorMessage"] != null)
                {
                    <div class="alert alert-error">
                        <i class="fas fa-exclamation-circle"></i> @TempData["ErrorMessage"]
                    </div>
                }

                <form id="profileForm" method="post" action="@Url.Action("EditProfile", "Account")" enctype="multipart/form-data">
                    @Html.AntiForgeryToken()
                    <input type="hidden" id="userId" name="UserId" value="@Model.UserId" />
                    <input type="hidden" id="currentAvatar" value="@Model.AvatarUrl" />

                    <div class="row">
                        <label for="fullName">Họ và tên <span class="required">*</span></label>
                        <input id="fullName" name="FullName" type="text" class="value" value="@Model.FullName" aria-label="Họ tên" readonly required>
                    </div>

                    <div class="row">
                        <label for="email">Email</label>
                        <input id="email" type="email" class="value" value="@Model.Email" aria-label="Email" readonly disabled>
                    </div>

                    <div class="row">
                        <label for="phone">Số điện thoại <span class="required">*</span></label>
                        <input id="phone" name="PhoneNumber" type="text" class="value" value="@Model.PhoneNumber" aria-label="Số điện thoại" readonly required>
                    </div>

                    <div style="margin-bottom:1rem;">
                        <label style="display:block; margin-bottom:10px;">Địa chỉ</label>
                        <div class="address-grid">
                            <div>
                                <select id="province" name="Province" aria-label="Tỉnh / Thành phố" disabled>
                                    <option value="">Chọn tỉnh / thành phố</option>
                                </select>
                            </div>
                            <div>
                                <input id="ward" name="Ward" type="text" class="value" value="@Model.Ward" placeholder="Nhập phường / xã" aria-label="Phường / Xã" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="row" style="margin-bottom:0.5rem">
                        <label for="addressDetail">Địa chỉ chi tiết</label>
                        <input id="addressDetail" name="AddressDetail" type="text" class="value" value="@Model.AddressDetail" placeholder="Số nhà, tên đường..." readonly>
                    </div>

                    <div class="row" style="margin-bottom:0.5rem">
                        <label>Ngày tạo tài khoản</label>
                        <div style="flex:1;">
                            <div class="meta" id="createdAt">@(Model.CreatedDate?.ToString("dd/MM/yyyy HH:mm") ?? "Chưa cập nhật")</div>
                        </div>
                    </div>

                    <div class="row" style="margin-bottom:0.5rem">
                        <label>Cập nhật lần cuối</label>
                        <div style="flex:1;">
                            <div class="meta" id="lastModified">@(Model.LastModified?.ToString("dd/MM/yyyy HH:mm") ?? "Chưa cập nhật")</div>
                        </div>
                    </div>

                    <div class="row" style="margin-top:6px;">
                        <label></label>
                        <div style="display:flex;flex-direction:column;gap:8px;">
                            <div class="small">Bạn có thể thay đổi avatar khi ở chế độ chỉnh sửa.</div>
                            <div style="display:flex;gap:10px;">
                                <input id="avatarInput" name="AvatarFile" type="file" accept="image/jpeg,image/png,image/jpg,image/gif" style="display:none">
                                <button class="btn" id="changeBtn" type="button" disabled>
                                    <i class="fas fa-camera"></i> Thay đổi avatar
                                </button>
                                <button class="btn ghost" id="resetBtn" type="button" disabled>
                                    <i class="fas fa-undo"></i> Khôi phục
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="actions" style="margin-top:6px;">
                        <a href="@Url.Action("Index", "Home")" class="btn ghost" style="text-decoration:none;">
                            <i class="fas fa-home"></i> Trang chủ
                        </a>
                        <button class="btn ghost" id="editBtn" type="button">
                            <i class="fas fa-edit"></i> Sửa
                        </button>
                        <button class="btn" id="saveBtn" type="submit" disabled>
                            <i class="fas fa-save"></i> Lưu
                        </button>
                        <a href="@Url.Action("ChangePassword", "Account")" class="btn ghost">
                            <i class="fas fa-key"></i> Đổi mật khẩu
                        </a>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script src="~/Scripts/jquery-3.7.1.min.js"></script>
    <script src="~/Scripts/CustomJS/Profile.js"></script>
</body>
</html>